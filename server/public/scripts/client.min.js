var myApp=angular.module("myApp",["ngRoute","ui.bootstrap"]);myApp.filter("startFrom",function(){return function(a,b){return a?(b=+b,a.slice(b)):[]}}),myApp.config(["$routeProvider","$locationProvider",function(a,b){b.hashPrefix(""),a.when("/home",{templateUrl:"/views/templates/home.html",controller:"LoginController"}).when("/register",{templateUrl:"/views/templates/register.html",controller:"LoginController"}).when("/user",{templateUrl:"/views/templates/user.html",controller:"ChildrenController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/info",{templateUrl:"/views/templates/info.html",controller:"ChildController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/info/:child_id/:name/:gender",{templateUrl:"/views/templates/info.html",controller:"ChildController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/events",{templateUrl:"/views/templates/events.html",controller:"InfoController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/milestones",{templateUrl:"/views/templates/milestones.html",controller:"InfoController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/medicalinfo",{templateUrl:"/views/templates/medicalinfo.html",controller:"InfoController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/resources",{templateUrl:"/views/templates/resource.html",controller:"ResourceController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/contact",{templateUrl:"/views/templates/contact.html",controller:"ContactController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).otherwise({redirectTo:"home"})}]),myApp.controller("ChildController",["$scope","$http","$location","$routeParams","filterFilter","$modal","ChildService",function(a,b,c,d,e,f,g){console.log("Child Control sourced :"),a.name=d.name;d.name;"boy"==d.gender?a.imgLoad="views/images/boy.png":a.imgLoad="views/images/girl.png",a.onEventComplete=function(){console.log("CALLBACK",a.eventsList.events.length),a.$watch("search",function(b,c){a.totalItems=a.eventsList.events.length,a.filtered=e(a.eventsList.events,b),a.totalItems=a.filtered.length,a.noOfPages=Math.ceil(a.totalItems/a.entryLimit),a.currentPage=1},!0)},g.getDetails(d.child_id,a.onEventComplete),a.eventsList=g.eventsList,a.editEvent=g.editEvent,a.removeEvent=function(b){swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Delete It!",closeOnConfirm:!1},function(){swal("Deleted!","Your event has been deleted.","success"),g.removeEvent(b,a.onEventComplete)})},a.thisEvent={},a.addDetail=function(b){console.log("this event",b),b.id=d.child_id,g.addDetail(b,a.onEventComplete)},a.search={},a.resetFilters=function(){a.search={}},a.entryLimit=3,a.currentPage=0,a.totalLeadItems=a.eventsList.events.length,a.range=function(){var b,c=3,d=[];(b=a.currentPage)>a.pageCount()-c&&(b=a.pageCount()-c+1);for(var e=b;e<b+c;e++)d.push(e);return d},a.prevPage=function(){a.currentPage>0&&a.currentPage--},a.pageCount=function(){return Math.ceil(a.totalItems/a.entryLimit)-1},a.nextPage=function(){a.currentPage<a.pageCount()&&a.currentPage++},a.setPage=function(b){a.currentPage=0}}]),myApp.controller("ChildrenController",["$scope","$http","$location","UserService",function(a,b,c,d){console.log("child sourced :");var e={};d.getChildren(),a.childrenList=d.childrenList,a.editaChild=function(a){d.editaChild(a)},a.addChild=function(){swal.withForm({title:"Congrats! Add Your Baby",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Add Data",closeOnConfirm:!0,formFields:[{id:"first",placeholder:"first name",required:!0},{id:"last",placeholder:"last name",required:!0},{id:"dob",placeholder:"birthday",required:!0},{name:"gender",value:"boy",type:"radio"},{name:"gender",value:"girl",type:"radio"}]},function(a){!0===a&&(e=this.swalForm,d.addChild(e))})}}]),myApp.controller("ContactController",["$scope","$http","$location","$routeParams","ContactService",function(a,b,c,d,e){console.log("Contact Control sourced :");var f={};e.getContacts(),a.contactList=e.contactList,console.log("contact",e.contactList),a.editContact=e.editContact,a.removeContact=function(a){swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Delete It!",closeOnConfirm:!1},function(){swal("Deleted!","Your contact has been deleted.","success"),e.removeContact(a)})},a.addContact=function(){swal.withForm({title:"Add a New Contact",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Add Data",closeOnConfirm:!0,formFields:[{id:"name",placeholder:"Name of a Place",required:!0},{id:"address",placeholder:"Address"},{id:"phone",placeholder:"Phone"},{id:"note",placeholder:"Note"}]},function(a){!0===a&&(f=this.swalForm,console.log("add data =",f),e.addContact(f))})}}]),myApp.controller("InfoController",["$scope","$http","$location","UserService",function(a,b,c,d){a.logout=d.logout}]),myApp.controller("LoginController",["$scope","$http","$location","UserService",function(a,b,c,d){a.user={username:"",password:""},a.message="",a.login=function(){""===a.user.username||""===a.user.password?a.message="Enter your username and password!":(console.log("sending to server...",a.user),b.post("/",a.user).then(function(b){b.data.username?(console.log("success: ",b.data),c.path("/user")):(console.log("failure: ",b),a.message="Wrong!!")}))},a.registerUser=function(){""===a.user.username||""===a.user.password?a.message="Choose a username and password!":(console.log("sending to server...",a.user),b.post("/register",a.user).then(function(a){console.log("success"),c.path("/home")},function(b){console.log("error"),a.message="Please try again."}))}}]),myApp.controller("ResourceController",["$scope","$http","$location","$routeParams","ResourceService",function(a,b,c,d,e){console.log("Resource Control sourced :");var f={};e.getResources(),a.resourceList=e.resourceList,console.log("resource",e.resourceList),a.editResource=e.editResource,a.removeResource=function(a){swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Delete It!",closeOnConfirm:!1},function(){swal("Deleted!","Your resource has been deleted.","success"),e.removeResource(a)})},a.addResource=function(){swal.withForm({title:"Add a New Resource",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Add Data",closeOnConfirm:!0,formFields:[{id:"title",placeholder:"title",required:!0},{id:"link",placeholder:"link name"},{id:"note",placeholder:"Note"}]},function(a){!0===a&&(f=this.swalForm,console.log("add data =",f),e.addResource(f))})}}]),myApp.controller("UserController",["$scope","$http","$location","UserService",function(a,b,c,d){a.userObject=d.userObject,a.logout=d.logout}]),myApp.factory("ChildService",["$http","$location","$route",function(a,b,c){console.log("User Service Loaded");var d={events:[]},e=function(b,c){console.log("child event",b),void 0!==b.weight?(console.log("metrics"),a.post("/detail/metric",b).then(function(a){f(b.id,c)})):(console.log("not metrics"),a.post("/detail/activity",b).then(function(a){f(b.id,c)}))},f=function(b,c){a.get("/detail/"+b).then(function(a){d.events=a.data,void 0!==c&&c()})},g=function(b,c){a.delete("/detail/"+b._id).then(function(a){f(b.child_id,c)})};return{editEvent:function(b,c){a.put("/detail",b).then(function(a){f(b.child_id,c)})},removeEvent:g,getDetails:f,eventsList:d,addDetail:e}}]),myApp.factory("ContactService",["$http","$location","$route",function(a,b,c){console.log("User Service Loaded");var d={lists:[]},e=function(b){a.post("/contact",b).then(function(a){console.log("get response",a),f()})},f=function(){a.get("/contact").then(function(a){console.log("response",a),d.lists=a.data})},g=function(b){a.delete("/contact/"+b._id).then(function(a){f()})};return{contactList:d,getContacts:f,addContact:e,removeContact:g}}]),myApp.factory("ResourceService",["$http","$location","$route",function(a,b,c){console.log("User Service Loaded");var d={lists:[]},e=function(b){a.post("/resource",b).then(function(a){console.log("get response",a),f()})},f=function(){a.get("/resource").then(function(a){console.log("response",a),d.lists=a.data})},g=function(b){a.delete("/resource/"+b._id).then(function(a){f()})};return{resourceList:d,getResources:f,addResource:e,removeResource:g}}]),myApp.factory("UserService",["$http","$location",function(a,b){console.log("User Service Loaded");var c={},d={},e=function(){a.get("/child").then(function(a){d.children=a.data})};return{userObject:c,addChild:function(b){console.log("child "+b),a.post("/child",b).then(function(a){e()})},getChildren:e,childrenList:d,editaChild:function(b){a.put("/child",b).then(function(a){console.log(a),e()})},getuser:function(){a.get("/user").then(function(a){a.data.username?(c.userName=a.data.username,console.log("User Data: ",c.userName)):b.path("/home")})},logout:function(){a.get("/user/logout").then(function(a){console.log("logged out"),b.path("/home")})}}}]);